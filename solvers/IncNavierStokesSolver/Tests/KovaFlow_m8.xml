<?xml version="1.0" encoding="utf-8" ?>

<NEKTAR xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="http://www.nektar.info/schema/nektar.xsd">

    <EXPANSIONS>
        <E COMPOSITE="C[0]" NUMMODES="6" FIELDS="u,v,p" TYPE="MODIFIED" />
    </EXPANSIONS>

    <CONDITIONS>
        <SOLVERINFO>
            <I PROPERTY="SolverType" VALUE="VelocityCorrectionScheme" />
            <I PROPERTY="EQTYPE" VALUE="UnsteadyNavierStokes" />
            <I PROPERTY="AdvectionForm" VALUE="Convective" />
            <I PROPERTY="Projection" VALUE="Galerkin" />
            <I PROPERTY="TimeIntegrationMethod" VALUE="IMEXOrder1" />
        </SOLVERINFO>

        <PARAMETERS>
            <P> TimeStep      = 0.001        </P>
            <P> NumSteps      = 100       </P>
            <P> IO_CheckSteps = 100       </P>
            <P> IO_InfoSteps  = 100       </P>
            <P> Kinvis        = 0.025        </P>
        </PARAMETERS>

        <VARIABLES>
            <V ID="0"> u </V>
            <V ID="1"> v </V>
            <V ID="2"> p </V>
        </VARIABLES>

        <BOUNDARYREGIONS>
            <B ID="0"> C[1] </B>
            <B ID="1"> C[2] </B>
            <B ID="2"> C[3] </B>
        </BOUNDARYREGIONS>

        <BOUNDARYCONDITIONS>
            <REGION REF="0">
                <D VAR="u" VALUE="1-1.619099729265964*cos(2*PI*y)" />
                <D VAR="v" VALUE="-0.248344108585656*sin(2*PI*y)" />
                <N VAR="p" USERDEFINEDTYPE="H" VALUE="0" />
            </REGION>
            <REGION REF="1">
                <D VAR="u" VALUE="1-0.381463333531742*cos(2*PI*y)" />
                <D VAR="v" VALUE="-0.058510399212408*sin(2*PI*y)" />
                <D VAR="p" VALUE="0.427242862585425" />
            </REGION>
            <REGION REF="2">
                <N VAR="u" VALUE="0" />
                <D VAR="v" VALUE="0" />
                <N VAR="p" VALUE="0" />
            </REGION>
        </BOUNDARYCONDITIONS>

        <FUNCTION NAME="InitialConditions">
            <F VAR="u,v,p" FILE="KovaFlow_m8.rst" />
        </FUNCTION>

        <FUNCTION NAME="ExactSolution">
            <E VAR="u" VALUE="(1-exp(-0.963740544195769*x)*cos(2*PI*y))" />
            <E VAR="v"
                VALUE="(-0.963740544195769/(2*PI))*exp(-0.963740544195769*x)*sin(2*PI*y)" />
            <E VAR="p" VALUE="0.5*(1-exp(-2*0.963740544195769*x))" />
        </FUNCTION>

    </CONDITIONS>

    <GEOMETRY DIM="2" SPACE="2">

        <VERTEX COMPRESSED="B64Z">eJxjYGBg6KtngIIH+1FpBgZGrPI/7GEiTCjyH+zR5ZmxyiPMZ8Fq/ge4flbs7oPLs6HJr5+YzPM/q8IWJsIOlY92rHkVXF2zF91+DlT9GO7jRHM/1Py9MBEu7P6Du48bqzzCfzxY7UeEHy+q+23R5fmw6keYz4/df3B5ATR5d/P7P3e5JcD9JwiVf7xvqahibY4tuvlCUPmmsp+NV/7326CbL4zi/py9UPPh8QMAbZlisQAA</VERTEX>
        <EDGE COMPRESSED="B64Z">eJxNkAcOgzAQBE2cCqGlkQL8/5ncSBPJSKtZltMtdkop7ULXUCU7M9iEsiTbm/ehg6xDR8ncyXwIneWlUK3+3xuZ7c/Otb63dsLR3aPZoL8V7CW6F2L2oecfn5Lul/u5g0ly1rdk90fPub+Sjp+eO5glHYueZ5X0be6GBGkA</EDGE>
        <ELEMENT>
            <Q ID="0">    0     1     2     3 </Q>
            <Q ID="1">    2     4     5     6 </Q>
            <Q ID="2">    5     7     8     9 </Q>
            <Q ID="3">    8    10    11    12 </Q>
            <Q ID="4">   13    14    15     1 </Q>
            <Q ID="5">   15    16    17     4 </Q>
            <Q ID="6">   17    18    19     7 </Q>
            <Q ID="7">   19    20    21    10 </Q>
            <Q ID="8">   22    23    24    14 </Q>
            <Q ID="9">   24    25    26    16 </Q>
            <Q ID="10">   26    27    28    18 </Q>
            <Q ID="11">   28    29    30    20 </Q>
        </ELEMENT>

        <COMPOSITE>
            <C ID="0"> Q[0-11]             </C>     <!-- Domain -->
            <C ID="1"> E[23,25,27,29]      </C>     <!-- Inflow -->
            <C ID="2"> E[3,6,9,12]         </C>     <!-- Outflow -->
            <C ID="3"> E[0,11,13,21,22,30] </C>     <!-- Walls -->
        </COMPOSITE>

        <DOMAIN> C[0] </DOMAIN>

    </GEOMETRY>

</NEKTAR>
